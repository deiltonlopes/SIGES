<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : ScreenListeners
Description : M&#243;dulo que estabelece a&#231;&#245;es e l&#243;gica das telas e de leitura de dados no sistema SIGES.
-}</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TUI.ScreenListeners</span><span class="hs-special">(</span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="TUI.ScreenListeners.html"><span class="hs-identifier">TUI.ScreenListeners</span></a></span><span>
</span><span id="line-7"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Console.Haskeline</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Hkl</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Manager.html"><span class="hs-identifier">Manager</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="TUI.OutputScreens.html"><span class="hs-identifier">TUI.OutputScreens</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Handlers.ErrorHandler.html"><span class="hs-identifier">Handlers.ErrorHandler</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Handlers.UserHandler.html"><span class="hs-identifier">Handlers.UserHandler</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Handlers.DataHandler.html"><span class="hs-identifier">Handlers.DataHandler</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Handlers.RoomsHandler.html"><span class="hs-identifier">Handlers.RoomsHandler</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- | Typeclass que estabelece as opera&#231;&#245;es de a&#231;&#245;es a ser executadas em cada tela do sistema.</span><span>
</span><span id="line-20"></span><span class="hs-keyword">class</span><span> </span><span id="Action"><span class="annot"><a href="TUI.ScreenListeners.html#Action"><span class="hs-identifier hs-var">Action</span></a></span></span><span> </span><span id="local-6989586621679098745"><span class="annot"><a href="#local-6989586621679098745"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>    </span><span id="useContent"><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-type">useContent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098745"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Datatypes.html#Screen"><span class="hs-identifier hs-type">Screen</span></a></span><span> </span><span class="hs-comment">-- ^ A implementa&#231;&#227;o de como a tela ser&#225; impressa na tela e como ler&#225; as informa&#231;&#245;es dadas pelo usu&#225;rio.</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="TUI.ScreenListeners.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="Datatypes.html#Screen"><span class="hs-identifier hs-type">Screen</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>    </span><span id="local-6989586621679098693"><span class="annot"><span class="annottext">useContent :: Screen -&gt; IO Screen
</span><a href="#local-6989586621679098693"><span class="hs-identifier hs-var hs-var hs-var hs-var">useContent</span></a></span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ExitScreen"><span class="hs-identifier hs-var">ExitScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ExitScreen"><span class="hs-identifier hs-var">ExitScreen</span></a></span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><span class="annottext">IO Screen
forall a. IO a
</span><span class="hs-identifier hs-var">exitSuccess</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#FirstScreen"><span class="hs-identifier hs-var">FirstScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#FirstScreen"><span class="hs-identifier hs-var">FirstScreen</span></a></span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o e-mail do novo usu&#225;rio?&quot;</span></span><span>
</span><span id="line-31"></span><span>        </span><span id="local-6989586621679098687"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098687"><span class="hs-identifier hs-var">email</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkNewEmail"><span class="hs-identifier hs-var">checkNewEmail</span></a></span><span>
</span><span id="line-32"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098687"><span class="hs-identifier hs-var">email</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Retornar&quot;</span></span><span>
</span><span id="line-33"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#StartScreen"><span class="hs-identifier hs-var">StartScreen</span></a></span><span>
</span><span id="line-34"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-35"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual &#233; a senha do novo usu&#225;rio?&quot;</span></span><span>
</span><span id="line-36"></span><span>                </span><span id="local-6989586621679098682"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098682"><span class="hs-identifier hs-var">password</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getPassword"><span class="hs-identifier hs-var">getPassword</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkNewPass"><span class="hs-identifier hs-var">checkNewPass</span></a></span><span>
</span><span id="line-37"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o nome do novo usu&#225;rio?&quot;</span></span><span>
</span><span id="line-38"></span><span>                </span><span id="local-6989586621679098679"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098679"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkName"><span class="hs-identifier hs-var">checkName</span></a></span><span>
</span><span id="line-39"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Bool -&gt; IO ()
</span><a href="Handlers.UserHandler.html#registerNewUser"><span class="hs-identifier hs-var">registerNewUser</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098687"><span class="hs-identifier hs-var">email</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098682"><span class="hs-identifier hs-var">password</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098679"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-40"></span><span>                </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#AdminScreen"><span class="hs-identifier hs-var">AdminScreen</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#StartScreen"><span class="hs-identifier hs-var">StartScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><span class="annottext">IO ()
</span><a href="Handlers.DataHandler.html#signOutUser"><span class="hs-identifier hs-var">signOutUser</span></a></span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><span class="annottext">IO Bool
</span><a href="Handlers.RoomsHandler.html#cleanAllReservations"><span class="hs-identifier hs-var">cleanAllReservations</span></a></span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#StartScreen"><span class="hs-identifier hs-var">StartScreen</span></a></span><span>
</span><span id="line-46"></span><span>        </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Screen)) -&gt; IO Screen
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Screen -&gt; String -&gt; IO (Either String Screen)
</span><a href="Handlers.ErrorHandler.html#validScreen"><span class="hs-identifier hs-var">validScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#StartScreen"><span class="hs-identifier hs-var">StartScreen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoginScreen"><span class="hs-identifier hs-var">LoginScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-49"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoginScreen"><span class="hs-identifier hs-var">LoginScreen</span></a></span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual &#233; o seu e-mail?&quot;</span></span><span>
</span><span id="line-51"></span><span>        </span><span id="local-6989586621679098671"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098671"><span class="hs-identifier hs-var">email</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkEmail"><span class="hs-identifier hs-var">checkEmail</span></a></span><span>
</span><span id="line-52"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098671"><span class="hs-identifier hs-var">email</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Retornar&quot;</span></span><span>
</span><span id="line-53"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#StartScreen"><span class="hs-identifier hs-var">StartScreen</span></a></span><span>
</span><span id="line-54"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-55"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual &#233; a sua senha?&quot;</span></span><span>
</span><span id="line-56"></span><span>                </span><span id="local-6989586621679098669"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098669"><span class="hs-identifier hs-var">password</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getPassword"><span class="hs-identifier hs-var">getPassword</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkPass"><span class="hs-identifier hs-var">checkPass</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098671"><span class="hs-identifier hs-var">email</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Handlers.DataHandler.html#signUser"><span class="hs-identifier hs-var">signUser</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098671"><span class="hs-identifier hs-var">email</span></a></span><span>
</span><span id="line-58"></span><span>                </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-61"></span><span>        </span><span id="local-6989586621679098665"><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098665"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO User
</span><a href="Handlers.DataHandler.html#getLoggedUser"><span class="hs-identifier hs-var">getLoggedUser</span></a></span><span>
</span><span id="line-62"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098663"><span class="annot"><span class="annottext">userScreen :: Screen
</span><a href="#local-6989586621679098663"><span class="hs-identifier hs-var hs-var">userScreen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">User -&gt; Bool
</span><a href="Datatypes.html#isAdminUser"><span class="hs-identifier hs-var hs-var">isAdminUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098665"><span class="hs-identifier hs-var">user</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#AdminScreen"><span class="hs-identifier hs-var">AdminScreen</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>
</span><span id="line-63"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679098663"><span class="hs-identifier hs-var">userScreen</span></a></span><span>
</span><span id="line-64"></span><span>        </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Screen)) -&gt; IO Screen
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Screen -&gt; String -&gt; IO (Either String Screen)
</span><a href="Handlers.ErrorHandler.html#validScreen"><span class="hs-identifier hs-var">validScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679098663"><span class="hs-identifier hs-var">userScreen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#AdminScreen"><span class="hs-identifier hs-var">AdminScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall a. Action a =&gt; a -&gt; IO Screen
</span><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#InsertRoomScreen"><span class="hs-identifier hs-var">InsertRoomScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-69"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#InsertRoomScreen"><span class="hs-identifier hs-var">InsertRoomScreen</span></a></span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o nome/c&#243;digo da sala a ser criada?&quot;</span></span><span>
</span><span id="line-71"></span><span>        </span><span id="local-6989586621679098660"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098660"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkNewRoomCode"><span class="hs-identifier hs-var">checkNewRoomCode</span></a></span><span>
</span><span id="line-72"></span><span>        </span><span class="annot"><span class="annottext">IO ()
</span><a href="Handlers.RoomsHandler.html#printCategories"><span class="hs-identifier hs-var">printCategories</span></a></span><span>
</span><span id="line-73"></span><span>        </span><span id="local-6989586621679098657"><span class="annot"><span class="annottext">RoomCategory
</span><a href="#local-6989586621679098657"><span class="hs-identifier hs-var">category</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
-&gt; (String -&gt; IO (Either String RoomCategory)) -&gt; IO RoomCategory
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String RoomCategory)
</span><a href="Handlers.ErrorHandler.html#checkCategory"><span class="hs-identifier hs-var">checkCategory</span></a></span><span>
</span><span id="line-74"></span><span>        </span><span id="local-6989586621679098655"><span class="annot"><span class="annottext">[Resource]
</span><a href="#local-6989586621679098655"><span class="hs-identifier hs-var">resources</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Resource]
</span><a href="TUI.ScreenListeners.html#getResources"><span class="hs-identifier hs-var">getResources</span></a></span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual a capacidade da sala a ser criada?&quot;</span></span><span>
</span><span id="line-76"></span><span>        </span><span id="local-6989586621679098653"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098653"><span class="hs-identifier hs-var">capacity</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Int)) -&gt; IO Int
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String Int)
</span><a href="Handlers.ErrorHandler.html#checkNumber"><span class="hs-identifier hs-var">checkNumber</span></a></span><span>
</span><span id="line-77"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual a localiza&#231;&#227;o da sala a ser criada?&quot;</span></span><span>
</span><span id="line-78"></span><span>        </span><span id="local-6989586621679098651"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098651"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either String String -&gt; IO (Either String String)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either String String -&gt; IO (Either String String))
-&gt; (String -&gt; Either String String)
-&gt; String
-&gt; IO (Either String String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String String
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; [Resource] -&gt; RoomCategory -&gt; Int -&gt; String -&gt; IO Bool
</span><a href="Handlers.RoomsHandler.html#createRoom"><span class="hs-identifier hs-var">createRoom</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098660"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">[Resource]
</span><a href="#local-6989586621679098655"><span class="hs-identifier hs-var">resources</span></a></span><span> </span><span class="annot"><span class="annottext">RoomCategory
</span><a href="#local-6989586621679098657"><span class="hs-identifier hs-var">category</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098653"><span class="hs-identifier hs-var">capacity</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098651"><span class="hs-identifier hs-var">location</span></a></span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Sala criada! &quot;</span></span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#waitInput"><span class="hs-identifier hs-var">waitInput</span></a></span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#SignUpScreen"><span class="hs-identifier hs-var">SignUpScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#SignUpScreen"><span class="hs-identifier hs-var">SignUpScreen</span></a></span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o e-mail do novo usu&#225;rio?&quot;</span></span><span>
</span><span id="line-87"></span><span>        </span><span id="local-6989586621679098645"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098645"><span class="hs-identifier hs-var">email</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkNewEmail"><span class="hs-identifier hs-var">checkNewEmail</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098645"><span class="hs-identifier hs-var">email</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Retornar&quot;</span></span><span>
</span><span id="line-89"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>
</span><span id="line-90"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-91"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual &#233; a senha do novo usu&#225;rio?&quot;</span></span><span>
</span><span id="line-92"></span><span>                </span><span id="local-6989586621679098644"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098644"><span class="hs-identifier hs-var">password</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getPassword"><span class="hs-identifier hs-var">getPassword</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkNewPass"><span class="hs-identifier hs-var">checkNewPass</span></a></span><span>
</span><span id="line-93"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o nome do novo usu&#225;rio?&quot;</span></span><span>
</span><span id="line-94"></span><span>                </span><span id="local-6989586621679098643"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098643"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkName"><span class="hs-identifier hs-var">checkName</span></a></span><span>
</span><span id="line-95"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Este usu&#225;rio &#233; administrador (S/N)?&quot;</span></span><span>
</span><span id="line-96"></span><span>                </span><span id="local-6989586621679098642"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098642"><span class="hs-identifier hs-var">isAdm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Bool)) -&gt; IO Bool
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String Bool)
</span><a href="Handlers.ErrorHandler.html#yesOrNo"><span class="hs-identifier hs-var">yesOrNo</span></a></span><span>
</span><span id="line-97"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Bool -&gt; IO ()
</span><a href="Handlers.UserHandler.html#registerNewUser"><span class="hs-identifier hs-var">registerNewUser</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098645"><span class="hs-identifier hs-var">email</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098644"><span class="hs-identifier hs-var">password</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098643"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098642"><span class="hs-identifier hs-var">isAdm</span></a></span><span>
</span><span id="line-98"></span><span>                </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#RemoveUserScreen"><span class="hs-identifier hs-var">RemoveUserScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-101"></span><span>        </span><span id="local-6989586621679098639"><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098639"><span class="hs-identifier hs-var">admUser</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO User
</span><a href="Handlers.DataHandler.html#getLoggedUser"><span class="hs-identifier hs-var">getLoggedUser</span></a></span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#RemoveUserScreen"><span class="hs-identifier hs-var">RemoveUserScreen</span></a></span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o e-mail do usu&#225;rio a ser deletado?&quot;</span></span><span>
</span><span id="line-104"></span><span>        </span><span id="local-6989586621679098638"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098638"><span class="hs-identifier hs-var">email</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkEmail"><span class="hs-identifier hs-var">checkEmail</span></a></span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098638"><span class="hs-identifier hs-var">email</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Retornar&quot;</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>                </span><span id="local-6989586621679098637"><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098637"><span class="hs-identifier hs-var">currentUser</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO User
</span><a href="Handlers.UserHandler.html#retrieveUser"><span class="hs-identifier hs-var">retrieveUser</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098638"><span class="hs-identifier hs-var">email</span></a></span><span>
</span><span id="line-108"></span><span>                </span><span class="annot"><span class="annottext">User -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098637"><span class="hs-identifier hs-var">currentUser</span></a></span><span>
</span><span id="line-109"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Insira sua senha para confirmar:&quot;</span></span><span>
</span><span id="line-110"></span><span>                </span><span id="local-6989586621679098635"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098635"><span class="hs-identifier hs-var">admPassword</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getPassword"><span class="hs-identifier hs-var">getPassword</span></a></span><span> </span><span class="annot"><span class="annottext">((String -&gt; IO (Either String String)) -&gt; IO String)
-&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkPass"><span class="hs-identifier hs-var">checkPass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Datatypes.html#emailUser"><span class="hs-identifier hs-var hs-var">emailUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098639"><span class="hs-identifier hs-var">admUser</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>                </span><span class="annot"><span class="annottext">User -&gt; IO ()
</span><a href="Handlers.UserHandler.html#removeUser"><span class="hs-identifier hs-var">removeUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098637"><span class="hs-identifier hs-var">currentUser</span></a></span><span>
</span><span id="line-112"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Usu&#225;rio removido!&quot;</span></span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ViewUserScreen"><span class="hs-identifier hs-var">ViewUserScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ViewUserScreen"><span class="hs-identifier hs-var">ViewUserScreen</span></a></span><span>
</span><span id="line-117"></span><span>        </span><span id="local-6989586621679098631"><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098631"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO User
</span><a href="Handlers.DataHandler.html#getLoggedUser"><span class="hs-identifier hs-var">getLoggedUser</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span id="local-6989586621679098630"><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098630"><span class="hs-identifier hs-var">rooms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Room]
</span><a href="Handlers.RoomsHandler.html#searchRoomsRequester"><span class="hs-identifier hs-var">searchRoomsRequester</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO [Room]) -&gt; String -&gt; IO [Room]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Datatypes.html#nameUser"><span class="hs-identifier hs-var hs-var">nameUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098631"><span class="hs-identifier hs-var">user</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Room] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098630"><span class="hs-identifier hs-var">rooms</span></a></span><span>
</span><span id="line-120"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Sem dados de salas encontrados para &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Datatypes.html#nameUser"><span class="hs-identifier hs-var hs-var">nameUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098631"><span class="hs-identifier hs-var">user</span></a></span><span>
</span><span id="line-121"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Room -&gt; IO ()) -&gt; [Room] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Room -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098630"><span class="hs-identifier hs-var">rooms</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nDeseja visualizar de outras formas/alguma sala espec&#237;fica [S/N]?&quot;</span></span><span>
</span><span id="line-123"></span><span>        </span><span id="local-6989586621679098625"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098625"><span class="hs-identifier hs-var">more</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Bool)) -&gt; IO Bool
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String Bool)
</span><a href="Handlers.ErrorHandler.html#yesOrNo"><span class="hs-identifier hs-var">yesOrNo</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Screen -&gt; IO Screen) -&gt; Screen -&gt; IO Screen
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098625"><span class="hs-identifier hs-var">more</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ViewScreen"><span class="hs-identifier hs-var">ViewScreen</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ViewScreen"><span class="hs-identifier hs-var">ViewScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ViewScreen"><span class="hs-identifier hs-var">ViewScreen</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span id="local-6989586621679098623"><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679098623"><span class="hs-identifier hs-var">screen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Screen)) -&gt; IO Screen
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Screen -&gt; String -&gt; IO (Either String Screen)
</span><a href="Handlers.ErrorHandler.html#validScreen"><span class="hs-identifier hs-var">validScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ViewScreen"><span class="hs-identifier hs-var">ViewScreen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>        </span><span id="local-6989586621679098622"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098622"><span class="hs-identifier hs-var">loggedUser</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="Handlers.DataHandler.html#hasLoggedUser"><span class="hs-identifier hs-var">hasLoggedUser</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Screen -&gt; IO Screen) -&gt; Screen -&gt; IO Screen
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679098623"><span class="hs-identifier hs-var">screen</span></a></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; Screen -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#StartScreen"><span class="hs-identifier hs-var">StartScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098622"><span class="hs-identifier hs-var">loggedUser</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679098623"><span class="hs-identifier hs-var">screen</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ViewRoomScreen"><span class="hs-identifier hs-var">ViewRoomScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ViewRoomScreen"><span class="hs-identifier hs-var">ViewRoomScreen</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o c&#243;digo/nome da sala que voc&#234; quer visualizar?&quot;</span></span><span>
</span><span id="line-135"></span><span>        </span><span id="local-6989586621679098618"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098618"><span class="hs-identifier hs-var">roomCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkRoomCode"><span class="hs-identifier hs-var">checkRoomCode</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679098616"><span class="annot"><span class="annottext">Room
</span><a href="#local-6989586621679098616"><span class="hs-identifier hs-var">room</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Maybe Room)
</span><a href="Handlers.DataHandler.html#getRoom"><span class="hs-identifier hs-var">getRoom</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098618"><span class="hs-identifier hs-var">roomCode</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><span class="annottext">Room -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">Room
</span><a href="#local-6989586621679098616"><span class="hs-identifier hs-var">room</span></a></span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#waitInput"><span class="hs-identifier hs-var">waitInput</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span id="local-6989586621679098614"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098614"><span class="hs-identifier hs-var">userLogged</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="Handlers.DataHandler.html#hasLoggedUser"><span class="hs-identifier hs-var">hasLoggedUser</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Screen -&gt; IO Screen) -&gt; Screen -&gt; IO Screen
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098614"><span class="hs-identifier hs-var">userLogged</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#StartScreen"><span class="hs-identifier hs-var">StartScreen</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ViewFilterScreen"><span class="hs-identifier hs-var">ViewFilterScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ViewFilterScreen"><span class="hs-identifier hs-var">ViewFilterScreen</span></a></span><span>
</span><span id="line-144"></span><span>        </span><span id="local-6989586621679098612"><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098612"><span class="hs-identifier hs-var">rooms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Room] -&gt; IO [Room]
</span><a href="TUI.ScreenListeners.html#getRoomsFilter"><span class="hs-identifier hs-var">getRoomsFilter</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Room] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098612"><span class="hs-identifier hs-var">rooms</span></a></span><span>
</span><span id="line-146"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Sem dados de salas encontrados\n&quot;</span></span><span>
</span><span id="line-147"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Room -&gt; IO ()) -&gt; [Room] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Room -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098612"><span class="hs-identifier hs-var">rooms</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#waitInput"><span class="hs-identifier hs-var">waitInput</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span id="local-6989586621679098610"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098610"><span class="hs-identifier hs-var">userLogged</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="Handlers.DataHandler.html#hasLoggedUser"><span class="hs-identifier hs-var">hasLoggedUser</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Screen -&gt; IO Screen) -&gt; Screen -&gt; IO Screen
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098610"><span class="hs-identifier hs-var">userLogged</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#StartScreen"><span class="hs-identifier hs-var">StartScreen</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ReportRoomScreen"><span class="hs-identifier hs-var">ReportRoomScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ReportRoomScreen"><span class="hs-identifier hs-var">ReportRoomScreen</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o c&#243;digo/nome da sala que voc&#234; quer visualizar?&quot;</span></span><span>
</span><span id="line-155"></span><span>        </span><span id="local-6989586621679098608"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098608"><span class="hs-identifier hs-var">roomCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkRoomCode"><span class="hs-identifier hs-var">checkRoomCode</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679098607"><span class="annot"><span class="annottext">Room
</span><a href="#local-6989586621679098607"><span class="hs-identifier hs-var">room</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Maybe Room)
</span><a href="Handlers.DataHandler.html#getRoom"><span class="hs-identifier hs-var">getRoom</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098608"><span class="hs-identifier hs-var">roomCode</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o dia de ocupa&#231;&#227;o voc&#234; deseja ver [DD-MM-AAAA]?&quot;</span></span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098606"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098606"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098605"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098605"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098604"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098604"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkDay"><span class="hs-identifier hs-var">checkDay</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer, Int, Int) -&gt; Room -&gt; String
</span><a href="Handlers.RoomsHandler.html#createReportForTheRoom"><span class="hs-identifier hs-var">createReportForTheRoom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098606"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098605"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098604"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Room
</span><a href="#local-6989586621679098607"><span class="hs-identifier hs-var">room</span></a></span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#waitInput"><span class="hs-identifier hs-var">waitInput</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span id="local-6989586621679098601"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098601"><span class="hs-identifier hs-var">userLogged</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="Handlers.DataHandler.html#hasLoggedUser"><span class="hs-identifier hs-var">hasLoggedUser</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Screen -&gt; IO Screen) -&gt; Screen -&gt; IO Screen
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098601"><span class="hs-identifier hs-var">userLogged</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#StartScreen"><span class="hs-identifier hs-var">StartScreen</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ReportDayScreen"><span class="hs-identifier hs-var">ReportDayScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#ReportDayScreen"><span class="hs-identifier hs-var">ReportDayScreen</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o dia de ocupa&#231;&#227;o voc&#234; deseja ver [DD-MM-AAAA]?&quot;</span></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098599"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098599"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098598"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098598"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098597"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098597"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkDay"><span class="hs-identifier hs-var">checkDay</span></a></span><span>
</span><span id="line-168"></span><span>        </span><span id="local-6989586621679098596"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098596"><span class="hs-identifier hs-var">report</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Integer, Int, Int) -&gt; IO String
</span><a href="Handlers.RoomsHandler.html#createReportForTheDay"><span class="hs-identifier hs-var">createReportForTheDay</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098599"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098598"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098597"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098596"><span class="hs-identifier hs-var">report</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#waitInput"><span class="hs-identifier hs-var">waitInput</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span id="local-6989586621679098594"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098594"><span class="hs-identifier hs-var">userLogged</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="Handlers.DataHandler.html#hasLoggedUser"><span class="hs-identifier hs-var">hasLoggedUser</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Screen -&gt; IO Screen) -&gt; Screen -&gt; IO Screen
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098594"><span class="hs-identifier hs-var">userLogged</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#StartScreen"><span class="hs-identifier hs-var">StartScreen</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#CreateReservationScreen"><span class="hs-identifier hs-var">CreateReservationScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#CreateReservationScreen"><span class="hs-identifier hs-var">CreateReservationScreen</span></a></span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o c&#243;digo/nome da sala que voc&#234; quer reservar?&quot;</span></span><span>
</span><span id="line-177"></span><span>        </span><span id="local-6989586621679098592"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098592"><span class="hs-identifier hs-var">roomCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkRoomCode"><span class="hs-identifier hs-var">checkRoomCode</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o dia da reserva [DD-MM-AAAA]?&quot;</span></span><span>
</span><span id="line-179"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098591"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098591"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098590"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098590"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098589"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098589"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkDay"><span class="hs-identifier hs-var">checkDay</span></a></span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o hor&#225;rio de in&#237;cio [HH:MM]?&quot;</span></span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098588"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098588"><span class="hs-identifier hs-var">hStart</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098587"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098587"><span class="hs-identifier hs-var">mStart</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkTime"><span class="hs-identifier hs-var">checkTime</span></a></span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o hor&#225;rio de t&#233;rmino [HH:MM]?&quot;</span></span><span>
</span><span id="line-183"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098585"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098585"><span class="hs-identifier hs-var">hEnd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098584"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098584"><span class="hs-identifier hs-var">mEnd</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkTime"><span class="hs-identifier hs-var">checkTime</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;D&#234; uma breve descri&#231;&#227;o sobre a reserva&quot;</span></span><span>
</span><span id="line-185"></span><span>        </span><span id="local-6989586621679098583"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098583"><span class="hs-identifier hs-var">description</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkDescription"><span class="hs-identifier hs-var">checkDescription</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679098581"><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098581"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO User
</span><a href="Handlers.DataHandler.html#getLoggedUser"><span class="hs-identifier hs-var">getLoggedUser</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span id="local-6989586621679098580"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098580"><span class="hs-identifier hs-var">created</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; String
-&gt; (Integer, Int, Int, Int, Int)
-&gt; (Integer, Int, Int, Int, Int)
-&gt; IO Bool
</span><a href="Handlers.RoomsHandler.html#makeReservation"><span class="hs-identifier hs-var">makeReservation</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098592"><span class="hs-identifier hs-var">roomCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Datatypes.html#nameUser"><span class="hs-identifier hs-var hs-var">nameUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098581"><span class="hs-identifier hs-var">user</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098583"><span class="hs-identifier hs-var">description</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098591"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098590"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098589"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098588"><span class="hs-identifier hs-var">hStart</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098587"><span class="hs-identifier hs-var">mStart</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098591"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098590"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098589"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098585"><span class="hs-identifier hs-var">hEnd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098584"><span class="hs-identifier hs-var">mEnd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098580"><span class="hs-identifier hs-var">created</span></a></span><span>
</span><span id="line-190"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Reserva criada! &quot;</span></span><span>
</span><span id="line-191"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Sala j&#225; ocupada neste hor&#225;rio. &quot;</span></span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#waitInput"><span class="hs-identifier hs-var">waitInput</span></a></span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#EditReservationScreen"><span class="hs-identifier hs-var">EditReservationScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#EditReservationScreen"><span class="hs-identifier hs-var">EditReservationScreen</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o c&#243;digo/nome da sala que voc&#234; quer editar a reserva?&quot;</span></span><span>
</span><span id="line-198"></span><span>        </span><span id="local-6989586621679098577"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098577"><span class="hs-identifier hs-var">roomCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkRoomCode"><span class="hs-identifier hs-var">checkRoomCode</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o dia da reserva feita [DD-MM-AAAA]?&quot;</span></span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098576"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098576"><span class="hs-identifier hs-var">yOld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098575"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098575"><span class="hs-identifier hs-var">mOld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098574"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098574"><span class="hs-identifier hs-var">dOld</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkDay"><span class="hs-identifier hs-var">checkDay</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o hor&#225;rio de in&#237;cio da reserva feita [HH:MM]?&quot;</span></span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098573"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098573"><span class="hs-identifier hs-var">hOldStart</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098572"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098572"><span class="hs-identifier hs-var">minOldStart</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkTime"><span class="hs-identifier hs-var">checkTime</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o novo dia da reserva [DD-MM-AAAA]?&quot;</span></span><span>
</span><span id="line-204"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098571"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098571"><span class="hs-identifier hs-var">yNew</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098570"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098570"><span class="hs-identifier hs-var">mNew</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098569"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098569"><span class="hs-identifier hs-var">dNew</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkDay"><span class="hs-identifier hs-var">checkDay</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o novo hor&#225;rio de in&#237;cio da reserva [HH:MM]?&quot;</span></span><span>
</span><span id="line-206"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098568"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098568"><span class="hs-identifier hs-var">hNewStart</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098567"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098567"><span class="hs-identifier hs-var">minNewStart</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkTime"><span class="hs-identifier hs-var">checkTime</span></a></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o novo hor&#225;rio de t&#233;rmino da reserva [HH:MM]?&quot;</span></span><span>
</span><span id="line-208"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098566"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098566"><span class="hs-identifier hs-var">hNewEnd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098565"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098565"><span class="hs-identifier hs-var">minNewEnd</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkTime"><span class="hs-identifier hs-var">checkTime</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>        </span><span id="local-6989586621679098564"><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098564"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO User
</span><a href="Handlers.DataHandler.html#getLoggedUser"><span class="hs-identifier hs-var">getLoggedUser</span></a></span><span>
</span><span id="line-211"></span><span>        </span><span id="local-6989586621679098563"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098563"><span class="hs-identifier hs-var">edited</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; (Integer, Int, Int, Int, Int)
-&gt; (Integer, Int, Int, Int, Int)
-&gt; (Integer, Int, Int, Int, Int)
-&gt; IO Bool
</span><a href="Handlers.RoomsHandler.html#editReservation"><span class="hs-identifier hs-var">editReservation</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098577"><span class="hs-identifier hs-var">roomCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Datatypes.html#nameUser"><span class="hs-identifier hs-var hs-var">nameUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098564"><span class="hs-identifier hs-var">user</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098576"><span class="hs-identifier hs-var">yOld</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098575"><span class="hs-identifier hs-var">mOld</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098574"><span class="hs-identifier hs-var">dOld</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098573"><span class="hs-identifier hs-var">hOldStart</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098572"><span class="hs-identifier hs-var">minOldStart</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098571"><span class="hs-identifier hs-var">yNew</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098570"><span class="hs-identifier hs-var">mNew</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098569"><span class="hs-identifier hs-var">dNew</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098568"><span class="hs-identifier hs-var">hNewStart</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098567"><span class="hs-identifier hs-var">minNewStart</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098571"><span class="hs-identifier hs-var">yNew</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098570"><span class="hs-identifier hs-var">mNew</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098569"><span class="hs-identifier hs-var">dNew</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098566"><span class="hs-identifier hs-var">hNewEnd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098565"><span class="hs-identifier hs-var">minNewEnd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098563"><span class="hs-identifier hs-var">edited</span></a></span><span>
</span><span id="line-213"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Reserva editada! &quot;</span></span><span>
</span><span id="line-214"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A reserva n&#227;o existe ou j&#225; est&#225; ocupada no novo hor&#225;rio. &quot;</span></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#waitInput"><span class="hs-identifier hs-var">waitInput</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#RemoveReservationScreen"><span class="hs-identifier hs-var">RemoveReservationScreen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen -&gt; String
forall a. Content a =&gt; a -&gt; String
</span><a href="TUI.OutputScreens.html#getContent"><span class="hs-identifier hs-var">getContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#RemoveReservationScreen"><span class="hs-identifier hs-var">RemoveReservationScreen</span></a></span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o c&#243;digo/nome da sala que voc&#234; quer remover a reserva?&quot;</span></span><span>
</span><span id="line-221"></span><span>        </span><span id="local-6989586621679098560"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098560"><span class="hs-identifier hs-var">roomCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String String)) -&gt; IO String
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String String)
</span><a href="Handlers.ErrorHandler.html#checkRoomCode"><span class="hs-identifier hs-var">checkRoomCode</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o dia da reserva feita [DD-MM-AAAA]?&quot;</span></span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098559"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098559"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098558"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098558"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098557"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098557"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkDay"><span class="hs-identifier hs-var">checkDay</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o hor&#225;rio de in&#237;cio da reserva feita [HH:MM]?&quot;</span></span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679098556"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098556"><span class="hs-identifier hs-var">hStart</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098555"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098555"><span class="hs-identifier hs-var">minStart</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkTime"><span class="hs-identifier hs-var">checkTime</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>        </span><span id="local-6989586621679098554"><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098554"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO User
</span><a href="Handlers.DataHandler.html#getLoggedUser"><span class="hs-identifier hs-var">getLoggedUser</span></a></span><span>
</span><span id="line-228"></span><span>        </span><span id="local-6989586621679098553"><span class="annot"><span class="annottext">Reservation
</span><a href="#local-6989586621679098553"><span class="hs-identifier hs-var">reservation</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Integer, Int, Int, Int, Int) -&gt; String -&gt; IO Reservation
</span><a href="Handlers.RoomsHandler.html#findReservation"><span class="hs-identifier hs-var">findReservation</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098560"><span class="hs-identifier hs-var">roomCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098559"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098558"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098557"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098556"><span class="hs-identifier hs-var">hStart</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098555"><span class="hs-identifier hs-var">minStart</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Datatypes.html#nameUser"><span class="hs-identifier hs-var hs-var">nameUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098554"><span class="hs-identifier hs-var">user</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>        </span><span class="annot"><span class="annottext">Reservation -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">Reservation
</span><a href="#local-6989586621679098553"><span class="hs-identifier hs-var">reservation</span></a></span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Confirma a dele&#231;&#227;o da reserva acima [S/N]?&quot;</span></span><span>
</span><span id="line-231"></span><span>        </span><span id="local-6989586621679098551"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098551"><span class="hs-identifier hs-var">toDelete</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Bool)) -&gt; IO Bool
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String Bool)
</span><a href="Handlers.ErrorHandler.html#yesOrNo"><span class="hs-identifier hs-var">yesOrNo</span></a></span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098551"><span class="hs-identifier hs-var">toDelete</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; String -&gt; (Integer, Int, Int, Int, Int) -&gt; IO Bool
</span><a href="Handlers.RoomsHandler.html#deleteReservation"><span class="hs-identifier hs-var">deleteReservation</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098560"><span class="hs-identifier hs-var">roomCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; String
</span><a href="Datatypes.html#nameUser"><span class="hs-identifier hs-var hs-var">nameUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679098554"><span class="hs-identifier hs-var">user</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098559"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098558"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098557"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098556"><span class="hs-identifier hs-var">hStart</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098555"><span class="hs-identifier hs-var">minStart</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Reserva deletada. &quot;</span></span><span>
</span><span id="line-235"></span><span>                </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#waitInput"><span class="hs-identifier hs-var">waitInput</span></a></span><span>
</span><span id="line-236"></span><span>                </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>        </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#LoggedScreen"><span class="hs-identifier hs-var">LoggedScreen</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Esta &#233; a fun&#231;&#227;o respons&#225;vel por encontrar e controlar quais telas ser&#227;o exibidas no sistema SIGES.</span><span>
</span><span id="line-240"></span><span class="annot"><a href="TUI.ScreenListeners.html#userInteraction"><span class="hs-identifier hs-type">userInteraction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Datatypes.html#Screen"><span class="hs-identifier hs-type">Screen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Datatypes.html#Screen"><span class="hs-identifier hs-type">Screen</span></a></span><span>
</span><span id="line-241"></span><span id="userInteraction"><span class="annot"><span class="annottext">userInteraction :: Screen -&gt; IO Screen
</span><a href="TUI.ScreenListeners.html#userInteraction"><span class="hs-identifier hs-var hs-var">userInteraction</span></a></span></span><span> </span><span id="local-6989586621679098547"><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679098547"><span class="hs-identifier hs-var">screen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679098546"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098546"><span class="hs-identifier hs-var">firstAccess</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="Handlers.DataHandler.html#noUsersYet"><span class="hs-identifier hs-var">noUsersYet</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098544"><span class="annot"><span class="annottext">currentScreen :: Screen
</span><a href="#local-6989586621679098544"><span class="hs-identifier hs-var hs-var">currentScreen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098546"><span class="hs-identifier hs-var">firstAccess</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="Datatypes.html#FirstScreen"><span class="hs-identifier hs-var">FirstScreen</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679098547"><span class="hs-identifier hs-var">screen</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">Screen -&gt; IO Screen
forall a. Action a =&gt; a -&gt; IO Screen
</span><a href="TUI.ScreenListeners.html#useContent"><span class="hs-identifier hs-var">useContent</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679098544"><span class="hs-identifier hs-var">currentScreen</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><a href="TUI.ScreenListeners.html#waitInput"><span class="hs-identifier hs-type">waitInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-248"></span><span id="waitInput"><span class="annot"><span class="annottext">waitInput :: IO String
</span><a href="TUI.ScreenListeners.html#waitInput"><span class="hs-identifier hs-var hs-var">waitInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Aperte qualquer tecla para continuar&quot;</span></span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><span class="annottext">IO String
</span><span class="hs-identifier hs-var">getLine</span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Esta fun&#231;&#227;o exibir&#225; um prompt e captar&#225; a resposta digitada pelo usu&#225;rio.</span><span>
</span><span id="line-253"></span><span class="annot"><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-type">getAnswer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-254"></span><span id="getAnswer"><span class="annot"><span class="annottext">getAnswer :: IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var hs-var">getAnswer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&gt; &quot;</span></span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hFlush</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><span class="annottext">IO String
</span><span class="hs-identifier hs-var">getLine</span></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">-- | Fun&#231;&#227;o respons&#225;vel por captar a senha do usu&#225;rio da entrada e garantir que ela seja exibida apenas com asteriscos, como forma de melhorar a seguran&#231;a.</span><span>
</span><span id="line-260"></span><span class="annot"><a href="TUI.ScreenListeners.html#getPassword"><span class="hs-identifier hs-type">getPassword</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-261"></span><span id="getPassword"><span class="annot"><span class="annottext">getPassword :: IO String
</span><a href="TUI.ScreenListeners.html#getPassword"><span class="hs-identifier hs-var hs-var">getPassword</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Settings IO -&gt; InputT IO String -&gt; IO String
forall (m :: * -&gt; *) a.
(MonadIO m, MonadMask m) =&gt;
Settings m -&gt; InputT m a -&gt; m a
</span><span class="hs-identifier hs-var">Hkl.runInputT</span></span><span> </span><span class="annot"><span class="annottext">Settings IO
forall (m :: * -&gt; *). MonadIO m =&gt; Settings m
</span><span class="hs-identifier hs-var">Hkl.defaultSettings</span></span><span> </span><span class="annot"><span class="annottext">(InputT IO String -&gt; IO String) -&gt; InputT IO String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span id="local-6989586621679098538"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679098538"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Char -&gt; String -&gt; InputT IO (Maybe String)
forall (m :: * -&gt; *).
(MonadIO m, MonadMask m) =&gt;
Maybe Char -&gt; String -&gt; InputT m (Maybe String)
</span><span class="hs-identifier hs-var">Hkl.getPassword</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Maybe Char
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&gt; &quot;</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; InputT IO String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; InputT IO String) -&gt; String -&gt; InputT IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; String
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679098538"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">-- | Dada uma M&#244;nada de String qualquer e uma fun&#231;&#227;o de verifica&#231;&#227;o, esta fun&#231;&#227;o aplicar&#225; a fun&#231;&#227;o sobre a String. Caso a String passe na verifica&#231;&#227;o fornecida, ser&#225; retornada. Caso contr&#225;rio, uma mensagem de erro ser&#225; exibida e a fun&#231;&#227;o ser&#225; repetida com uma nova entrada.</span><span>
</span><span id="line-264"></span><span id="local-6989586621679098737"><span class="annot"><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-type">getInputData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Datatypes.html#ErrorLog"><span class="hs-identifier hs-type">ErrorLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098737"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679098737"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-265"></span><span id="getInputData"><span class="annot"><span class="annottext">getInputData :: IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var hs-var">getInputData</span></a></span></span><span> </span><span id="local-6989586621679098534"><span class="annot"><span class="annottext">IO String
</span><a href="#local-6989586621679098534"><span class="hs-identifier hs-var">getter</span></a></span></span><span> </span><span id="local-6989586621679098533"><span class="annot"><span class="annottext">String -&gt; IO (Either String a)
</span><a href="#local-6989586621679098533"><span class="hs-identifier hs-var">checker</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-266"></span><span>    </span><span id="local-6989586621679098532"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098532"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="#local-6989586621679098534"><span class="hs-identifier hs-var">getter</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679098531"><span class="annot"><span class="annottext">Either String a
</span><a href="#local-6989586621679098531"><span class="hs-identifier hs-var">checkedAnswer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String a)
</span><a href="#local-6989586621679098533"><span class="hs-identifier hs-var">checker</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098532"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String a
</span><a href="#local-6989586621679098531"><span class="hs-identifier hs-var">checkedAnswer</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679098530"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098530"><span class="hs-identifier hs-var">error</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098530"><span class="hs-identifier hs-var">error</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="#local-6989586621679098534"><span class="hs-identifier hs-var">getter</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String a)
</span><a href="#local-6989586621679098533"><span class="hs-identifier hs-var">checker</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679098529"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098529"><span class="hs-identifier hs-var">answer</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098529"><span class="hs-identifier hs-var">answer</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Esta filtrar&#225; salas pelos filtros escolhidos pelo usu&#225;rio. MAis de um filtro podem ser aplicados simultaneamente, neste caso, a fun&#231;&#227;o perguntar&#225; um a um quais filtros devem ser adicionados.</span><span>
</span><span id="line-273"></span><span class="annot"><a href="TUI.ScreenListeners.html#getRoomsFilter"><span class="hs-identifier hs-type">getRoomsFilter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Datatypes.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Datatypes.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span id="getRoomsFilter"><span class="annot"><span class="annottext">getRoomsFilter :: [Room] -&gt; IO [Room]
</span><a href="TUI.ScreenListeners.html#getRoomsFilter"><span class="hs-identifier hs-var hs-var">getRoomsFilter</span></a></span></span><span> </span><span id="local-6989586621679098528"><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098528"><span class="hs-identifier hs-var">previous</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Por qual crit&#233;rio voc&#234; deseja filtrar?\n\
              \1 - Categoria\n\
              \2 - Capacidade\n\
              \3 - Hor&#225;rio\n\
              \4 - Recursos&quot;</span></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679098527"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098527"><span class="hs-identifier hs-var">option</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Int)) -&gt; IO Int
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String Int)
</span><a href="Handlers.ErrorHandler.html#checkFilter"><span class="hs-identifier hs-var">checkFilter</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679098525"><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098525"><span class="hs-identifier hs-var">rooms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098527"><span class="hs-identifier hs-var">option</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-282"></span><span>                </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>                    </span><span class="annot"><span class="annottext">IO ()
</span><a href="Handlers.RoomsHandler.html#printCategories"><span class="hs-identifier hs-var">printCategories</span></a></span><span>
</span><span id="line-284"></span><span>                    </span><span id="local-6989586621679098524"><span class="annot"><span class="annottext">RoomCategory
</span><a href="#local-6989586621679098524"><span class="hs-identifier hs-var">cat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
-&gt; (String -&gt; IO (Either String RoomCategory)) -&gt; IO RoomCategory
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String RoomCategory)
</span><a href="Handlers.ErrorHandler.html#checkCategory"><span class="hs-identifier hs-var">checkCategory</span></a></span><span>
</span><span id="line-285"></span><span>                    </span><span class="annot"><span class="annottext">RoomCategory -&gt; IO [Room]
</span><a href="Handlers.RoomsHandler.html#searchRoomsCategory"><span class="hs-identifier hs-var">searchRoomsCategory</span></a></span><span> </span><span class="annot"><span class="annottext">RoomCategory
</span><a href="#local-6989586621679098524"><span class="hs-identifier hs-var">cat</span></a></span><span>
</span><span id="line-286"></span><span>                </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Capacidade m&#237;nima desejada: &quot;</span></span><span>
</span><span id="line-288"></span><span>                    </span><span id="local-6989586621679098522"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098522"><span class="hs-identifier hs-var">cap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Int)) -&gt; IO Int
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String Int)
</span><a href="Handlers.ErrorHandler.html#checkNumber"><span class="hs-identifier hs-var">checkNumber</span></a></span><span>
</span><span id="line-289"></span><span>                    </span><span class="annot"><span class="annottext">Int -&gt; IO [Room]
</span><a href="Handlers.RoomsHandler.html#searchRoomsCapacity"><span class="hs-identifier hs-var">searchRoomsCapacity</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098522"><span class="hs-identifier hs-var">cap</span></a></span><span>
</span><span id="line-290"></span><span>                </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-291"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o dia a ser buscado [DD-MM-AAAA]?&quot;</span></span><span>
</span><span id="line-292"></span><span>                    </span><span class="hs-special">[</span><span id="local-6989586621679098520"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098520"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098519"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098519"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679098518"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098518"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkDay"><span class="hs-identifier hs-var">checkDay</span></a></span><span>
</span><span id="line-293"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o hor&#225;rio de in&#237;cio a ser buscado [HH:MM]?&quot;</span></span><span>
</span><span id="line-294"></span><span>                    </span><span class="hs-special">[</span><span id="local-6989586621679098517"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098517"><span class="hs-identifier hs-var">hStart</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098516"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098516"><span class="hs-identifier hs-var">minStart</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkTime"><span class="hs-identifier hs-var">checkTime</span></a></span><span>
</span><span id="line-295"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual o hor&#225;rio de t&#233;rmino a ser buscado [HH:MM]?&quot;</span></span><span>
</span><span id="line-296"></span><span>                    </span><span class="hs-special">[</span><span id="local-6989586621679098515"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098515"><span class="hs-identifier hs-var">hEnd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098514"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098514"><span class="hs-identifier hs-var">minEnd</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String [Int])) -&gt; IO [Int]
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String [Int])
</span><a href="Handlers.ErrorHandler.html#checkTime"><span class="hs-identifier hs-var">checkTime</span></a></span><span>
</span><span id="line-297"></span><span>                    </span><span class="annot"><span class="annottext">(Integer, Int, Int, Int, Int)
-&gt; (Integer, Int, Int, Int, Int) -&gt; IO [Room]
</span><a href="Handlers.RoomsHandler.html#searchRoomsTime"><span class="hs-identifier hs-var">searchRoomsTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098520"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098519"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098518"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098517"><span class="hs-identifier hs-var">hStart</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098516"><span class="hs-identifier hs-var">minStart</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098520"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098519"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098518"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098515"><span class="hs-identifier hs-var">hEnd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098514"><span class="hs-identifier hs-var">minEnd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>                </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>                    </span><span id="local-6989586621679098512"><span class="annot"><span class="annottext">[Resource]
</span><a href="#local-6989586621679098512"><span class="hs-identifier hs-var">resources</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Resource]
</span><a href="TUI.ScreenListeners.html#getResources"><span class="hs-identifier hs-var">getResources</span></a></span><span>
</span><span id="line-300"></span><span>                    </span><span class="annot"><span class="annottext">[Resource] -&gt; IO [Room]
</span><a href="Handlers.RoomsHandler.html#searchRoomsResources"><span class="hs-identifier hs-var">searchRoomsResources</span></a></span><span> </span><span class="annot"><span class="annottext">[Resource]
</span><a href="#local-6989586621679098512"><span class="hs-identifier hs-var">resources</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098510"><span class="annot"><span class="annottext">intersected :: [Room]
</span><a href="#local-6989586621679098510"><span class="hs-identifier hs-var hs-var">intersected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Room] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098528"><span class="hs-identifier hs-var">previous</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098525"><span class="hs-identifier hs-var">rooms</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098525"><span class="hs-identifier hs-var">rooms</span></a></span><span> </span><span class="annot"><span class="annottext">[Room] -&gt; [Room] -&gt; [Room]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098528"><span class="hs-identifier hs-var">previous</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Deseja combinar sua busca com outro filtro [S/N]?&quot;</span></span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621679098508"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098508"><span class="hs-identifier hs-var">more</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Bool)) -&gt; IO Bool
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String Bool)
</span><a href="Handlers.ErrorHandler.html#yesOrNo"><span class="hs-identifier hs-var">yesOrNo</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098508"><span class="hs-identifier hs-var">more</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Room] -&gt; IO [Room]
</span><a href="TUI.ScreenListeners.html#getRoomsFilter"><span class="hs-identifier hs-var">getRoomsFilter</span></a></span><span> </span><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098510"><span class="hs-identifier hs-var">intersected</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Room] -&gt; IO [Room]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Room]
</span><a href="#local-6989586621679098510"><span class="hs-identifier hs-var">intersected</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- | Fun&#231;&#227;o auxiliar &#224; fun&#231;&#227;o de filtro de salas. Esta fun&#231;&#227;o ler&#225; da entrada recursos que o usu&#225;rio deseja buscar e suas respectivas quantidades, e ent&#227;o produzir&#225; uma lista de recursos com estas informa&#231;&#245;es e a retornar&#225;.</span><span>
</span><span id="line-308"></span><span class="hs-comment">{-getResources :: [Resource] -&gt; IO [Resource]
getResources previous = do
    kind &lt;- getInputData getAnswer checkResource
    putStrLn &quot;Qual a quantidade desejada/existente do recurso?&quot;
    quantity &lt;- getInputData getAnswer checkNumber
    let resources = previous ++ [Resource kind quantity]
    putStrLn &quot;Deseja buscar mais recursos [S/N]?&quot;
    more &lt;- getInputData getAnswer yesOrNo
    if more then getResources resources else return resources-}</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="annot"><a href="TUI.ScreenListeners.html#getResources"><span class="hs-identifier hs-type">getResources</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Datatypes.html#Resource"><span class="hs-identifier hs-type">Resource</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span id="getResources"><span class="annot"><span class="annottext">getResources :: IO [Resource]
</span><a href="TUI.ScreenListeners.html#getResources"><span class="hs-identifier hs-var hs-var">getResources</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098507"><span class="annot"><span class="annottext">action :: IO Resource
</span><a href="#local-6989586621679098507"><span class="hs-identifier hs-var hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-321"></span><span>        </span><span class="annot"><span class="annottext">IO ()
</span><a href="Handlers.RoomsHandler.html#printResources"><span class="hs-identifier hs-var">printResources</span></a></span><span class="hs-special">;</span><span>
</span><span id="line-322"></span><span>        </span><span id="local-6989586621679098505"><span class="annot"><span class="annottext">ResourceKind
</span><a href="#local-6989586621679098505"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
-&gt; (String -&gt; IO (Either String ResourceKind)) -&gt; IO ResourceKind
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String ResourceKind)
</span><a href="Handlers.ErrorHandler.html#checkResource"><span class="hs-identifier hs-var">checkResource</span></a></span><span class="hs-special">;</span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Qual a quantidade desejada/existente do recurso?&quot;</span></span><span class="hs-special">;</span><span>
</span><span id="line-324"></span><span>        </span><span id="local-6989586621679098503"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098503"><span class="hs-identifier hs-var">quantity</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Int)) -&gt; IO Int
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String Int)
</span><a href="Handlers.ErrorHandler.html#checkNumber"><span class="hs-identifier hs-var">checkNumber</span></a></span><span class="hs-special">;</span><span>
</span><span id="line-325"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Deseja buscar mais recursos [S/N]?&quot;</span></span><span class="hs-special">;</span><span>
</span><span id="line-326"></span><span>        </span><span class="annot"><span class="annottext">Resource -&gt; IO Resource
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Resource -&gt; IO Resource) -&gt; Resource -&gt; IO Resource
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ResourceKind -&gt; Int -&gt; Resource
</span><a href="Datatypes.html#Resource"><span class="hs-identifier hs-var">Resource</span></a></span><span> </span><span class="annot"><span class="annottext">ResourceKind
</span><a href="#local-6989586621679098505"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098503"><span class="hs-identifier hs-var">quantity</span></a></span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-328"></span><span>    </span><span id="local-6989586621679098501"><span class="annot"><span class="annottext">Resource
</span><a href="#local-6989586621679098501"><span class="hs-identifier hs-var">firstResource</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Resource
</span><a href="#local-6989586621679098507"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621679098500"><span class="annot"><span class="annottext">[Resource]
</span><a href="#local-6989586621679098500"><span class="hs-identifier hs-var">nextResources</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; IO Resource -&gt; IO [Resource]
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">whileM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO (Either String Bool)) -&gt; IO Bool
forall a. IO String -&gt; (String -&gt; IO (Either String a)) -&gt; IO a
</span><a href="TUI.ScreenListeners.html#getInputData"><span class="hs-identifier hs-var">getInputData</span></a></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="TUI.ScreenListeners.html#getAnswer"><span class="hs-identifier hs-var">getAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String Bool)
</span><a href="Handlers.ErrorHandler.html#yesOrNo"><span class="hs-identifier hs-var">yesOrNo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO Resource
</span><a href="#local-6989586621679098507"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><span class="annottext">[Resource] -&gt; IO [Resource]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Resource] -&gt; IO [Resource]) -&gt; [Resource] -&gt; IO [Resource]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Resource
</span><a href="#local-6989586621679098501"><span class="hs-identifier hs-var">firstResource</span></a></span><span class="annot"><span class="annottext">Resource -&gt; [Resource] -&gt; [Resource]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Resource]
</span><a href="#local-6989586621679098500"><span class="hs-identifier hs-var">nextResources</span></a></span></pre></body></html>